{"version":3,"sources":["../../../src/api/user/user.model.js"],"names":["UserSchema","mongoose","Schema","email","type","String","required","firstName","lastName","password","phone","token","active","Boolean","salt","timestamps","methods","generateAuthToken","jwt","sign","setPassword","crypto","randomBytes","toString","pbkdf2Sync","validPassword","hash","model"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,IAAMA,UAAU,GAAG,IAAIC,qBAASC,MAAb,CAAoB;AACnCC,EAAAA,KAAK,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,mBAAP;AAA1B,GAD4B;AAEnCC,EAAAA,SAAS,EAAE;AAAEH,IAAAA,IAAI,EAAEC,MAAR;AAAe,eAAS;AAAxB,GAFwB;AAGnCG,EAAAA,QAAQ,EAAE;AAAEJ,IAAAA,IAAI,EAAEC,MAAR;AAAe,eAAS;AAAxB,GAHyB;AAInCI,EAAAA,QAAQ,EAAE;AAAEL,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,QAAQ,EAAE,CAAC,IAAD,EAAO,sBAAP;AAA1B,GAJyB;AAKnCI,EAAAA,KAAK,EAAE;AAAEN,IAAAA,IAAI,EAAEC;AAAR,GAL4B;AAMnCM,EAAAA,KAAK,EAAE;AAAEP,IAAAA,IAAI,EAAEC,MAAR;AAAgB,eAAS;AAAzB,GAN4B;AAOnCO,EAAAA,MAAM,EAAE;AAAE,eAAS,IAAX;AAAiBR,IAAAA,IAAI,EAAES;AAAvB,GAP2B;AAQnCC,EAAAA,IAAI,EAAGT;AAR4B,CAApB,EASjB;AAAEU,EAAAA,UAAU,EAAE;AAAd,CATiB,CAAnB;;AAYAf,UAAU,CAACgB,OAAX,CAAmBC,iBAAnB,GAAuC,YAAW;AAC9C,MAAMN,KAAK,GAAGO,yBAAIC,IAAJ,CAAS;AACnBhB,IAAAA,KAAK,EAAE,KAAKA,KADO;AAEnBI,IAAAA,SAAS,EAAE,KAAKA,SAFG;AAGnBC,IAAAA,QAAQ,EAAE,KAAKA,QAHI;AAInBJ,IAAAA,IAAI,EAAE;AAJa,GAAT,EAKX,UALW,CAAd;;AAMA,OAAKO,KAAL,KAAeA,KAAf;AACA,SAAOA,KAAP;AACH,CATD,C,CAWA;;;AACAX,UAAU,CAACgB,OAAX,CAAmBI,WAAnB,GAAiC,YAAW;AACxC;AACA,OAAKN,IAAL,GAAYO,mBAAOC,WAAP,CAAmB,EAAnB,EAAuBC,QAAvB,CAAgC,KAAhC,CAAZ,CAFwC,CAIxC;;AAEA,OAAKd,QAAL,GAAgBY,mBAAOG,UAAP,CAAkB,KAAKf,QAAvB,EAAiC,KAAKK,IAAtC,EAChB,IADgB,EACV,EADU,YACIS,QADJ,OAAhB;AAEH,CARD,C,CAUA;;;AACAvB,UAAU,CAACgB,OAAX,CAAmBS,aAAnB,GAAmC,UAAShB,QAAT,EAAmB;AAClD,MAAMiB,IAAI,GAAGL,mBAAOG,UAAP,CAAkBf,QAAlB,EACb,KAAKK,IADQ,EACF,IADE,EACI,EADJ,YACkBS,QADlB,OAAb;;AAEA,SAAO,KAAKd,QAAL,KAAkBiB,IAAzB;AACH,CAJD;;eAMezB,qBAAS0B,KAAT,CAAe,OAAf,EAAwB3B,UAAxB,C","sourcesContent":["import mongoose from 'mongoose';\r\nimport crypto from 'crypto';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst UserSchema = new mongoose.Schema({\r\n    email: { type: String, required: [true, 'Email is required'] },\r\n    firstName: { type: String,default: null },\r\n    lastName: { type: String,default: null },\r\n    password: { type: String, required: [true, 'Password is required'] },\r\n    phone: { type: String },\r\n    token: { type: String, default: null},\r\n    active: { default: true, type: Boolean },\r\n    salt : String\r\n},{ timestamps: true });\r\n\r\n\r\nUserSchema.methods.generateAuthToken = function() {\r\n    const token = jwt.sign({\r\n        email: this.email,\r\n        firstName: this.firstName,\r\n        lastName: this.lastName,\r\n        type: \"user\",\r\n    }, \"AmrEraky\");\r\n    this.token === token; \r\n    return token;\r\n};\r\n\r\n// Method to set salt and hash the password for a user \r\nUserSchema.methods.setPassword = function() {    \r\n    // Creating a unique salt for a particular user \r\n    this.salt = crypto.randomBytes(16).toString('hex'); \r\n    \r\n    // Hashing user's salt and password with 1000 iterations, \r\n    \r\n    this.password = crypto.pbkdf2Sync(this.password, this.salt,  \r\n    1000, 64, `sha512`).toString(`hex`); \r\n}; \r\n     \r\n// Method to check the entered password is correct or not \r\nUserSchema.methods.validPassword = function(password) { \r\n    const hash = crypto.pbkdf2Sync(password,  \r\n    this.salt, 1000, 64, `sha512`).toString(`hex`); \r\n    return this.password === hash; \r\n};\r\n\r\nexport default mongoose.model('users', UserSchema);"],"file":"user.model.js"}